name: Comment opening announce

on:
  workflow_call:

jobs:
  comment_opening_announce:
    runs-on: ubuntu-latest
    timeout-minutes: 5

    permissions:
      pull-requests: write

    steps:
      - name: Set up opening announce
        id: opening_announce
        run: |
          lf='\n'
          message="@${{ github.event.pull_request.user.login }} ã•ã‚“ã€ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸï¼ :tada:"
          message+="${lf}${lf}ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ä¸‹è¨˜ã®æ‰‹é †ã§è¡Œã£ã¦ãã ã•ã„ã€‚"
          message+="${lf}1. ãƒªãƒªãƒ¼ã‚¹äºˆå®šã®\`develop\`ãƒ–ãƒ©ãƒ³ãƒã‚’\`main\`ãƒ–ãƒ©ãƒ³ãƒã«ãƒžãƒ¼ã‚¸ã—ã¾ã™ã€‚"
          message+="${lf}2. ã‚³ãƒ¼ãƒ‰ã‚ªãƒ¼ãƒŠãƒ¼ã®æ‰¿èªã‚’å—ã‘ã‚‹å‰ã«ãƒã‚§ãƒƒã‚¯ã‚’é€šéŽã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
          message+="${lf}    - \`linter\`ã«åˆæ ¼ã—ãªã‹ã£ãŸå ´åˆã¯ã€åŽŸå› ã‚’ç‰¹å®šã—ã¦ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚"
          message+="${lf}    - HTMLã®Markupãƒ«ãƒ¼ãƒ«ã¯[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](../../blob/main/doc/markup_rule.md)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
          message+="${lf}    - Lighthouseã®çµæžœã¯ 'ðŸ”´'èµ¤ï¼š**ä¿®æ­£å¿…é ˆ**ã€'ðŸŸ 'æ©™ï¼š**å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£**ã€'ðŸŸ¢'ç·‘ï¼š**å•é¡Œãªã—** ã§ã™ã€‚"
          message+="${lf}    - ã‚³ãƒ¼ãƒ‰ã‚ªãƒ¼ãƒŠãƒ¼ã‹ã‚‰\`approve\`ã•ã‚ŒãŸå ´åˆã€\`main\`ãƒ–ãƒ©ãƒ³ãƒã«ãƒžãƒ¼ã‚¸ã—ã¾ã™ã€‚"
          echo "message=${message}" >> $GITHUB_OUTPUT

      - name: Comment opening announce
        uses: actions/github-script@v7.0.1
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const params = {
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              body: '${{ steps.opening_announce.outputs.message }}'
            }
            await github.rest.issues.createComment(params)
