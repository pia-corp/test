name: HOOK

on:
  repository_dispatch:
    types: [update-posts]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Check webhook payload
        id: check-payload
        uses: actions/github-script@v6
        with:
          script: |
            const { payload } = context;
            console.log(`Received webhook event: ${payload.client_payload.id}`);
            console.log(`Payload data: ${JSON.stringify(payload)}`);

      # - name: Event Information
      #   run: |
      #     echo "Event is '${{ github.event.action }}'"
      #     echo "Event is '${{ github.event.client_payload }}'"
      #     echo "Event payload:"
      #     echo '${{ toJson(github.event.context.payload) }}' | jq '.'

      - name: Build Next.js App
        run: |


  # curl "https://70iz3quiza.microcms.io/api/v1/news/em2pj_ygl6n" -H "X-MICROCMS-API-KEY: 3ULBgPQ3H9xwDnj8GZ3ePlTccQn66gWPNY70"


  # AUTO_MERGE:
  #   needs: test
  #   uses: ./.github/workflows/_auto_merge_deploycd.yml
  #   secrets:
  #     APIKEY: '${{ secrets.MICROCMS_API_KEY }}'
  #     TOKEN: ${{ secrets.GITHUB_TOKEN }}
  #     PTOKEN: ${{ secrets.PERSONAL_ACCESS_TOKEN }}


#   {
#   service: 'webhook-test',
#   api: 'news',
#   id: 'x2xkcwog9521',
#   type: 'edit',
#   contents: {
#     old: {
#       id: 'x2xkcwog9521',
#       status: ['DRAFT'],
#       draftKey: 'Vyf_XTclTY',
#       publishValue: null,
#       draftValue: {
#         id: 'x2xkcwog9521',
#         createdAt: '2021-06-02T05:56:24.513Z',
#         updatedAt: '2021-06-02T06:05:09.601Z',
#         publishedAt: '2021-06-02T06:05:09.601Z',
#         revisedAt: '2021-06-02T06:05:09.601Z',
#         title: 'タイトルです',
#       },
#     },
#     new: {
#       id: 'x2xkcwog9521',
#       status: ['PUBLISH'],
#       draftKey: null,
#       publishValue: {
#         id: 'x2xkcwog9521',
#         createdAt: '2021-06-02T05:56:24.513Z',
#         updatedAt: '2021-06-02T06:05:09.601Z',
#         publishedAt: '2021-06-02T06:05:09.601Z',
#         revisedAt: '2021-06-02T06:05:09.601Z',
#         title: 'タイトルです',
#       },
#       draftValue: null,
#     },
#   },
# }
